<UserControl
    x:Class="Scrubbler.Plugin.Scrobblers.DatabaseScrobbler.ArtistResultsView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Scrubbler.Plugin.Scrobblers.DatabaseScrobbler"
    xmlns:beh="using:Microsoft.Xaml.Interactivity"
    xmlns:actions="using:Microsoft.Xaml.Interactions.Core">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <ScrollViewer x:Name="ScrollViewer">
            <beh:Interaction.Behaviors>
                <beh:DataTriggerBehavior Binding="{Binding TypedResults.Count}" Value="0">
                    <actions:ChangePropertyAction TargetObject="{Binding ElementName=ScrollViewer}"
                                      PropertyName="Visibility" Value="Collapsed"/>
                </beh:DataTriggerBehavior>
            </beh:Interaction.Behaviors>

            <ItemsRepeater ItemsSource="{Binding TypedResults}">
                <ItemsRepeater.Layout>
                    <FlowLayout Orientation="Horizontal" MinRowSpacing="8" MinColumnSpacing="8"/>
                </ItemsRepeater.Layout>

                <ItemsRepeater.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <beh:Interaction.Behaviors>
                                <beh:EventTriggerBehavior EventName="Tapped">
                                    <actions:InvokeCommandAction Command="{Binding ClickedCommand}" />
                                </beh:EventTriggerBehavior>
                            </beh:Interaction.Behaviors>

                            <Border Padding="8" BorderBrush="DarkGray" BorderThickness="1" CornerRadius="10">
                                <StackPanel Orientation="Vertical" Width="128" Height="156" Spacing="10">
                                    <Image
                                        Width="128"
                                        Height="128"
                                        Source="{Binding Image,
                                                 TargetNullValue=ms-appx:///Assets/noartistimage.png}" />

                                    <TextBlock MaxWidth="128"
                                           Text="{Binding Name}"
                                           TextAlignment="Center"
                                           TextTrimming="CharacterEllipsis"
                                           TextWrapping="NoWrap"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </DataTemplate>
                </ItemsRepeater.ItemTemplate>
            </ItemsRepeater>
        </ScrollViewer>

        <TextBlock x:Name="NoResultsText" HorizontalAlignment="Center" VerticalAlignment="Center" FontSize="24" Text="No artists found">
            <beh:Interaction.Behaviors>
                <beh:DataTriggerBehavior Binding="{Binding TypedResults.Count}" Value="0" ComparisonCondition="GreaterThan">
                    <actions:ChangePropertyAction TargetObject="{Binding ElementName=NoResultsText}"
                                      PropertyName="Visibility" Value="Collapsed"/>
                </beh:DataTriggerBehavior>
            </beh:Interaction.Behaviors>
        </TextBlock>
    </Grid>
</UserControl>
